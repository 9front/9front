#!/bin/rc -e
rfork ne
. /sys/lib/git/common.rc

gitup

flagfmt='r:remove'; args='file ...'
eval `''{aux/getflags $*} || exec aux/usage

s=A
if(~ $remove 1)
	s=R
if(~ $#* 0)
	exec aux/usage

paths=`$nl{cleanname -d $gitrel $* | drop $gitroot}
if(~ $s A)
	files=`$nl{walk -f ./$paths}
if not
	files=`$nl{cd .git/fs/HEAD/tree && walk -f ./$paths}
for(f in $files)
	echo $s NOQID 0 $f >> .git/INDEX9
exit ''
